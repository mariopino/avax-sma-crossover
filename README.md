# Backtesting the SMA crossover strategy on the AVAX-USD pair

Backtesting the SMA crossover strategy on the [AVAX-USD](https://finance.yahoo.com/quote/AVAX-USD/) pair using [Backtesting.py](https://kernc.github.io/backtesting.py/) Python library.

The script does the following:

- Download daily OHLCV data from Yahoo Finance
- Initial run with predefined parameters
- Optimization
- Run with optimized parameters
- Generates a candle chart with indicators and trades (SmaCross_n1-XX,n2-YY_.html)
- Generates a Heatmap for the different combination of slow and fast moving averages (SmaCross.html)
- Export trades to CSV file (trades.csv)

The best results were achieved using a 5% stop loss for both SHORT and LONG trades.

# Installation

## Clone repository:

```
git clone https://github.com/mariopino/avax-sma-crossover.git
cd avax-sma-crossover
```

## Create virtual environment

### VSCode

To create local environments in VS Code using virtual environments or Anaconda, you can follow these steps: open the Command Palette (Ctrl+Shift+P), search for the Python: Create Environment command, and select it, then select Venv.

Select and activate an environment

Use the `Python: Select Interpreter` command from the Command Palette (Ctrl+Shift+P) and then select `.\.venv\Scripts\python.exe`.

### Linux

```
python -m venv myvenv
source myvenv/bin/activate
```

## Install dependencies

```
pip install backtesting
pip install yfinance
```

# Execute script

## Windows

```
python.exe SmaCross.py
```

## Linux

```
python SmaCross.py
```

# Results:

```
Initial Backtest Results (n1=35, n2=170):

Start                     2020-07-13 00:00:00
End                       2025-04-19 00:00:00
Duration                   1741 days 00:00:00
Exposure Time [%]                     9.50389
Equity Final [$]                   6181.40039
Equity Peak [$]                   11566.32727
Commissions [$]                     146.60857
Return [%]                            -38.186
Buy & Hold Return [%]               -22.12618
Return (Ann.) [%]                    -9.96296
Volatility (Ann.) [%]                26.23261
CAGR [%]                             -9.59313
Sharpe Ratio                         -0.37979
Sortino Ratio                        -0.50267
Calmar Ratio                           -0.214
Alpha [%]                           -37.49081
Beta                                  0.03142
Max. Drawdown [%]                   -46.55693
Avg. Drawdown [%]                    -21.4767
Max. Drawdown Duration     1270 days 00:00:00
Avg. Drawdown Duration      352 days 00:00:00
# Trades                                    9
Win Rate [%]                              0.0
Best Trade [%]                       -4.98856
Worst Trade [%]                      -5.09607
Avg. Trade [%]                       -5.02063
Max. Trade Duration          83 days 00:00:00
Avg. Trade Duration          17 days 00:00:00
Profit Factor                             0.0
Expectancy [%]                       -5.02062
SQN                                 -19.91685

...

Optimization Results (n1=10, n2=16):

Start                     2020-07-13 00:00:00
End                       2025-04-19 00:00:00
Duration                   1741 days 00:00:00
Exposure Time [%]                    69.69516
Equity Final [$]                4858559.58111
Equity Peak [$]                 6100439.68544
Commissions [$]                  231539.12454
Return [%]                        48485.59581
Buy & Hold Return [%]               400.08891
Return (Ann.) [%]                   285.58302
Volatility (Ann.) [%]                 444.953
CAGR [%]                             265.7845
Sharpe Ratio                          0.64183
Sortino Ratio                         6.22285
Calmar Ratio                           4.9605
Alpha [%]                         48428.26418
Beta                                   0.1433
Max. Drawdown [%]                   -57.57136
Avg. Drawdown [%]                    -11.0314
Max. Drawdown Duration      245 days 00:00:00
Avg. Drawdown Duration       28 days 00:00:00
# Trades                                  102
Win Rate [%]                         32.35294
Best Trade [%]                      279.77769
Worst Trade [%]                      -5.20629
Avg. Trade [%]                        6.40173
Max. Trade Duration          77 days 00:00:00
Avg. Trade Duration          11 days 00:00:00
Profit Factor                         4.30295
Expectancy [%]                       10.76935
SQN                                   1.88176
Kelly Criterion                       0.17702
_strategy                 SmaCross(n1=10,n...
_equity_curve                             ...
_trades                          Size  Ent...
dtype: object

Best Run Trades:

      Type  EntryTime   ExitTime  EntryPrice   ExitPrice           PnL   ReturnPct Duration
0     Long 2020-10-17 2020-10-20    4.038541    3.838456 -4.948095e+02   -4.954381   3 days
1    Short 2020-10-24 2020-10-26    4.262106    4.475211 -4.737331e+02   -5.000000   2 days
2     Long 2020-10-31 2020-11-02    3.714938    3.682664 -7.803855e+01   -0.868763   2 days
3    Short 2020-11-02 2020-11-07    3.682664    3.866797 -4.443134e+02   -5.000000   5 days
4     Long 2020-11-16 2020-11-26    3.536580    3.359751 -4.212067e+02   -5.000000  10 days
5    Short 2020-12-03 2020-12-22    3.736139    3.094121  1.372635e+03   17.183998  19 days
6     Long 2020-12-22 2020-12-22    3.094121    2.942738 -4.571763e+02   -4.892597   0 days
7    Short 2020-12-24 2020-12-24    2.930465    3.062139 -3.984459e+02   -4.493284   0 days
8     Long 2021-01-05 2021-01-31    3.590670   11.997275  1.978915e+04  234.123576  26 days
9    Short 2021-01-31 2021-01-31   11.997275   12.583640 -1.377370e+03   -4.887480   0 days
10    Long 2021-02-03 2021-02-23   13.507195   32.310028  3.722961e+04  139.206045  20 days
11   Short 2021-02-23 2021-03-09   32.310028   33.893009 -3.127971e+03   -4.899350  14 days
12    Long 2021-03-11 2021-03-12   29.651203   28.228346 -2.906897e+03   -4.798649   1 days
13   Short 2021-03-28 2021-03-28   27.617247   29.013227 -2.909224e+03   -5.054743   0 days
14    Long 2021-04-06 2021-04-07   31.278708   29.684264 -2.780710e+03   -5.097537   1 days
15   Short 2021-04-23 2021-04-26   23.987833   25.236710 -2.688832e+03   -5.206293   3 days
16    Long 2021-05-04 2021-05-04   35.876583   34.135704 -2.371078e+03   -4.852411   0 days
17   Short 2021-05-19 2021-07-06   36.976425   12.050247  3.128235e+04   67.411000  48 days
18    Long 2021-07-06 2021-07-14   12.050247   11.425469 -4.022945e+03   -5.184773   8 days
19   Short 2021-07-18 2021-07-26   10.963819   11.474133 -3.417577e+03   -4.654533   8 days
20    Long 2021-07-30 2021-09-05   12.429551   47.204662  1.954709e+05  279.777691  37 days
21   Short 2021-09-05 2021-09-06   47.204662   49.500324 -1.287637e+04   -4.863209   1 days
22    Long 2021-09-12 2021-09-12   57.098942   54.306033 -1.229438e+04   -4.891349   0 days
23   Short 2021-10-04 2021-10-24   68.683022   65.435112  1.128324e+04    4.728839  20 days
24    Long 2021-10-24 2021-10-24   65.435112   62.186209 -1.238157e+04   -4.965076   0 days
25   Short 2021-12-03 2021-12-17  107.868294  113.259874 -1.182374e+04   -4.998299  14 days
26    Long 2021-12-20 2021-12-20  107.680351  102.290093 -1.122252e+04   -5.005795   0 days
27   Short 2022-01-02 2022-02-05  114.204704   77.465012  6.837257e+04   32.170034  34 days
28    Long 2022-02-05 2022-02-21   77.465012   73.446056 -1.455666e+04   -5.188091  16 days
29   Short 2022-02-22 2022-02-22   69.997147   73.488376 -1.323874e+04   -4.987674   0 days
30    Long 2022-03-06 2022-03-06   76.736824   72.891053 -1.261413e+04   -5.011636   0 days
31   Short 2022-03-11 2022-03-17   74.003334   77.704302 -1.193192e+04   -5.001083   6 days
32    Long 2022-03-20 2022-03-20   89.671478   85.209416 -1.125332e+04   -4.976010   0 days
33   Short 2022-04-11 2022-06-27   81.720695   19.698818  1.628074e+05   75.894945  77 days
34    Long 2022-06-27 2022-06-28   19.698818   18.707811 -1.896194e+04   -5.030796   1 days
35   Short 2022-07-06 2022-07-06   18.070461   18.967966 -1.774277e+04   -4.966696   0 days
36    Long 2022-07-12 2022-08-02   17.377901   23.653297  1.223389e+05   36.111360  21 days
37   Short 2022-08-02 2022-08-05   23.653297   24.841147 -2.311081e+04   -5.021921   3 days
38    Long 2022-08-06 2022-08-19   24.949106   23.702051 -2.180101e+04   -4.998395  13 days
39   Short 2022-08-21 2022-08-21   22.296768   23.418023 -2.079592e+04   -5.028779   0 days
40    Long 2022-09-12 2022-09-13   20.659657   19.625913 -1.961012e+04   -5.003684   1 days
41   Short 2022-09-20 2022-09-23   17.305649   18.169952 -1.855745e+04   -4.994341   3 days
42    Long 2022-10-02 2022-10-05   16.971268   17.437840  9.684631e+03    2.749187   3 days
43   Short 2022-10-05 2022-10-27   17.437840   17.015781  8.742934e+03    2.420358  22 days
44    Long 2022-10-27 2022-11-08   17.015781   16.164398 -1.847502e+04   -5.003493  12 days
45   Short 2022-11-11 2022-12-02   15.385247   12.888829  5.680350e+04   16.226051  21 days
46    Long 2022-12-02 2022-12-16   12.888829   13.171334  8.902864e+03    2.191860  14 days
47   Short 2022-12-16 2023-01-10   13.171334   12.207081  3.032673e+04    7.320848  25 days
48    Long 2023-01-10 2023-02-11   12.207081   17.802189  2.033934e+05   45.834939  32 days
49   Short 2023-02-11 2023-02-15   17.802189   18.688457 -3.215293e+04   -4.978423   4 days
50    Long 2023-02-22 2023-02-22   20.942158   19.893124 -3.067690e+04   -5.009197   0 days
51   Short 2023-03-02 2023-03-20   17.761551   17.563906  6.460428e+03    1.112770  18 days
52    Long 2023-03-20 2023-03-20   17.563906   16.684951 -2.931841e+04   -5.004323   0 days
53   Short 2023-04-02 2023-04-05   17.798557   17.647354  4.718597e+03    0.849525   3 days
54    Long 2023-04-05 2023-04-23   17.647354   16.764765 -2.795953e+04   -5.001253  18 days
55   Short 2023-04-26 2023-05-07   17.641899   16.635347  3.024084e+04    5.705461  11 days
56    Long 2023-05-07 2023-05-08   16.635347   16.445061 -6.396676e+03   -1.143869   1 days
57   Short 2023-05-08 2023-06-05   16.445061   14.783157  5.575353e+04   10.105790  28 days
58    Long 2023-06-05 2023-06-05   14.783157   14.043368 -3.034394e+04   -5.004272   0 days
59   Short 2023-06-08 2023-06-25   14.031625   13.023023  4.132142e+04    7.188064  17 days
60    Long 2023-06-25 2023-06-28   13.023023   12.373626 -3.066904e+04   -4.986525   3 days
61   Short 2023-07-07 2023-07-08   12.411574   13.031282 -2.911882e+04   -4.992981   1 days
62    Long 2023-07-10 2023-07-12   13.607631   12.927155 -2.764977e+04   -5.000692   2 days
63   Short 2023-07-26 2023-10-03   13.346123    9.326218  1.578979e+05   30.120397  69 days
64    Long 2023-10-03 2023-10-16    9.326218    9.173585 -1.114631e+04   -1.636598  13 days
65   Short 2023-10-16 2023-10-16    9.173585    9.631876 -3.340069e+04   -4.995765   0 days
66    Long 2023-10-25 2023-11-30   10.316444   21.088507  6.618355e+05  104.416424  36 days
67   Short 2023-11-30 2023-12-01   21.088507   22.140735 -6.451949e+04   -4.989582   1 days
68    Long 2023-12-04 2024-01-03   21.967602   40.645931  1.042419e+06   85.026712  30 days
69   Short 2024-01-03 2024-01-19   40.645931   33.530499  3.963083e+05   17.505892  16 days
70    Long 2024-01-19 2024-01-19   33.530499   31.851745 -1.329590e+05   -5.006647   0 days
71   Short 2024-01-21 2024-01-28   32.813831   34.448847 -1.254466e+05   -4.982703   7 days
72    Long 2024-02-02 2024-02-25   33.829781   36.739048  2.052895e+05    8.599723  23 days
73   Short 2024-02-25 2024-02-26   36.739048   38.574947 -1.292895e+05   -4.997133   1 days
74    Long 2024-03-03 2024-03-03   44.364845   42.117213 -1.242649e+05   -5.066247   0 days
75   Short 2024-03-28 2024-04-28   54.112019   34.430248  8.452533e+05   36.372272  31 days
76    Long 2024-04-28 2024-04-30   34.430248   32.708736 -1.582259e+05   -5.000000   2 days
77   Short 2024-05-02 2024-05-03   33.288101   34.952506 -1.500145e+05   -5.000000   1 days
78    Long 2024-05-10 2024-05-10   35.080654   33.326621 -1.422135e+05   -5.000000   0 days
79   Short 2024-05-15 2024-05-15   31.568510   33.146936 -1.348338e+05   -5.000000   0 days
80    Long 2024-05-22 2024-05-23   41.163742   39.105555 -1.278217e+05   -5.000000   1 days
81   Short 2024-06-01 2024-07-03   36.055855   28.642305  4.983610e+05   20.561292  32 days
82    Long 2024-07-03 2024-07-03   28.642305   27.210511 -1.458311e+05   -4.998880   0 days
83   Short 2024-07-11 2024-07-15   25.767328   27.056049 -1.383339e+05   -5.001376   4 days
84    Long 2024-07-18 2024-07-31   27.251877   25.890591 -1.309775e+05   -4.995199  13 days
85   Short 2024-08-01 2024-08-22   25.719090   23.527414  2.118561e+05    8.521589  21 days
86    Long 2024-08-22 2024-08-30   23.527414   22.351044 -1.346497e+05   -5.000000   8 days
87   Short 2024-09-04 2024-09-08   21.383656   22.452838 -1.276615e+05   -5.000000   4 days
88    Long 2024-09-14 2024-09-16   24.952677   23.704659 -1.210615e+05   -5.001539   2 days
89   Short 2024-10-05 2024-10-07   26.241280   27.553344 -1.147413e+05   -5.000000   2 days
90    Long 2024-10-15 2024-10-16   29.062817   27.609676 -1.087749e+05   -5.000000   1 days
91   Short 2024-10-26 2024-10-28   24.892988   26.137638 -1.031292e+05   -5.000000   2 days
92    Long 2024-11-11 2024-12-17   31.982672   48.993259  1.039976e+06   53.186888  36 days
93   Short 2024-12-17 2025-01-07   48.993259   44.097549  2.987117e+05    9.992619  21 days
94    Long 2025-01-07 2025-01-07   44.097549   41.892545 -1.641119e+05   -5.000288   0 days
95   Short 2025-01-15 2025-01-15   36.502625   38.327463 -1.555602e+05   -4.999199   0 days
96    Long 2025-01-23 2025-01-23   36.751457   34.913884 -1.474965e+05   -5.000000   0 days
97   Short 2025-01-27 2025-02-20   35.855473   23.727959  9.459825e+05   33.823327  24 days
98    Long 2025-02-20 2025-02-23   23.727959   25.816496  3.289530e+05    8.802010   3 days
99   Short 2025-02-23 2025-03-22   25.816496   19.154354  1.047215e+06   25.805755  27 days
100   Long 2025-03-22 2025-04-02   19.154354   18.196624 -2.548626e+05   -5.000066  11 days
101  Short 2025-04-05 2025-04-11   18.181719   19.090805 -2.416323e+05   -5.000000   6 days
```